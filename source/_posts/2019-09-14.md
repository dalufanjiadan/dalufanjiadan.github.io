---
title: mysql cheat sheet
date: 2019-09-14 16:58:13
tags:
    - mysql
categories:
    - [mysql]
toc: true
---

-

<!-- more -->

---

### 日期处理

-   `SELECT now();` - 当前日期时间
-   `SELECT CURDATE()` - 当前日期
-   `SELECT CURTIME()` - 当前时间

#### 日期时间选取函数

-   `DATE('2017-05-15 10:37:14.123456')` - 获取日期：2017-05-15
-   `TIME('2017-05-15 10:37:14.123456')` - 获取时间：10:37:14.123456
-   `YEAR('2017-05-15 10:37:14.123456')` - 获取年份
-   `MONTH('2017-05-15 10:37:14.123456')` - 获取月份
-   `DAY('2017-05-15 10:37:14.123456')` - 获取日
-   `HOUR('2017-05-15 10:37:14.123456')` - 获取时
-   `MINUTE('2017-05-15 10:37:14.123456')` - 获取分
-   `SECOND('2017-05-15 10:37:14.123456')` - 获取秒
-   `MICROSECOND('2017-05-15 10:37:14.123456')` - 获取毫秒
-   `QUARTER('2017-05-15 10:37:14.123456')` - 获取季度
-   `WEEK('2017-05-15 10:37:14.123456')` - 获取周
-   `DAYOFYEAR('2017-05-15 10:37:14.123456')` - 日期在年度中第几天
-   `DAYOFMONTH('2017-05-15 10:37:14.123456')` - 日期在月度中第几天
-   `DAYOFWEEK('2017-05-15 10:37:14.123456')` - 日期在周中第几天；周日为第一天

#### 日期计算

-   `SELECT LAST_DAY('2016-05-01')` - 月份中最后一天：2016-05-31
-   `DATE_ADD(date,INTERVAL expr type)` - 从日期加上指定的时间间隔
-   `DATE_SUB(date,INTERVAL expr type)` - 从日期减去指定的时间间隔

```sql
SELECT
	DATE_ADD('2017-05-15 10:37:14.123456', INTERVAL 1 YEAR);

-- 表示：2018-05-15 10:37:14.123456
SELECT
	DATE_ADD('2017-05-15 10:37:14.123456', INTERVAL 1 QUARTER);

-- 表示：2017-08-15 10:37:14.123456
SELECT
	DATE_ADD('2017-05-15 10:37:14.123456', INTERVAL 1 MONTH);

-- 表示：2017-06-15 10:37:14.123456
SELECT
	DATE_ADD('2017-05-15 10:37:14.123456', INTERVAL 1 WEEK);

-- 表示：2017-05-22 10:37:14.123456
SELECT
	DATE_ADD('2017-05-15 10:37:14.123456', INTERVAL 1 DAY);

-- 表示：2017-05-16 10:37:14.123456
SELECT
	DATE_ADD('2017-05-15 10:37:14.123456', INTERVAL 1 HOUR);

-- 表示：2017-05-15 11:37:14.123456
SELECT
	DATE_ADD('2017-05-15 10:37:14.123456', INTERVAL 1 MINUTE);

-- 表示：2017-05-15 10:38:14.123456
SELECT
	DATE_ADD('2017-05-15 10:37:14.123456', INTERVAL 1 SECOND);

-- 表示：2017-05-15 10:37:15.123456
SELECT
	DATE_ADD(
		'2017-05-15 10:37:14.123456',
		INTERVAL 1 MICROSECOND
	);
```

#### 日期转换函数

-   TIME_TO_SEC('01:00:05'); - 3605
-   TO_DAYS('2017-06-05'); - 736850
-   STR_TO_DATE('06.05.2017 19:40:30', '%m.%d.%Y %H:%i:%s');- 2017-06-05 19:40:30
-   DATE_FORMAT('2017-05-12 17:03:51', '%Y 年%m 月%d 日 %H 时%i 分%s 秒');- 2017 年 05 月 12 日 17 时 03 分 51 秒(具体需要什么格式的数据根据实际情况来;小写 h 为 12 小时制;)

---

### 插入

#### 获取插入记录的自增长 ID

```java
public void insert(Role role);
```

#### sql

```xml
<insert id="insert" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO
            role(role_name, role_name_zh)
        VALUES
            (#{roleName}, #{roleNameZh})
    </insert>
```

#### 获取自增

插入记录后，传入的参数`role`中的相应的属性`id`已经被设置为该记录在数据库中的 id 了。因此直接使用`role.getId()`即可获取记录 id。
